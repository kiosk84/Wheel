# План улучшений проекта "Колесо Фортуны"

## 1. Конфигурация и безопасность
- Вынести `BOT_TOKEN`, `ADMIN_ID`, порт сервера и другие настройки в файл `.env`.
- Использовать пакет `dotenv` для загрузки переменных окружения.
- Игнорировать `.env` в `.gitignore`.

## 2. Рефакторинг backend
- Разбить `functions/index.js` на модули:  
  - `routes/` для API-эндпоинтов (participants, winners, prizepool).  
  - `services/` для бизнес-логики (approve, reject, draw).  
  - `db/` для работы с БД.
- Перейти на `async/await` вместо callback-ов SQLite.
- Использовать ORM или query-builder (Sequelize, Knex) для безопасности и миграций.

## 3. API и документация
- Добавить маршруты RESTful:  
  - `GET /api/participants`  
  - `POST /api/participate`  
  - `GET /api/winners`  
  - и т.д.
- Интегрировать Swagger/OpenAPI для автогенерации документации.

## 4. Frontend сборка и архитектура
- Инициализировать проект через сборщик (Vite, Create React App).  
- Перенести JSX в отдельные `.jsx`/`.js` файлы, стили в `.css` или `.module.css`.
- Разбить UI на компоненты:  
  - `Wheel.jsx`, `Timer.jsx`, `Modal.jsx`, `Fireworks.jsx`, `Button.jsx`.
- Настроить Tailwind как PostCSS-плагин или CSS Modules.

## 5. Тестирование
- Добавить unit-тесты для бизнес-логики backend (Jest).
- Добавить интеграционные тесты API (Supertest).
- Добавить UI-тесты компонентов (React Testing Library или Cypress).

## 6. CI/CD
- Настроить сборку и тесты на GitHub Actions.  
- Автоматический деплой на Heroku/Vercel/Fly.io при пуше в `main`.

## 7. База данных и миграции
- Организовать миграции (umzug, sequelize-cli или Knex).
- Настроить резервное копирование SQLite или перейти на более мощную БД (PostgreSQL).

## 8. Логирование и мониторинг
- Интегрировать Winston или Pino для логирования (разные уровни: info, error).
- Отправлять ошибки и метрики в Sentry или Loggly.

## 9. Улучшения UX
- Добавить индикаторы загрузки (spinner) для асинхронных запросов.
- Валидация форм и вывод ошибок.
- Обеспечить адаптивность интерфейса.

## 10. Документация и README
- Обновить `README.md` с инструкциями по сборке и деплою.
- Добавить разделы:  
  - Структура проекта  
  - Запуск окружения (`npm start`, `npm run build`)  
  - Переменные окружения  
  - Контакты и поддержка

## 11. Централизованное логирование и обработка ошибок
- Интегрировать Winston или Pino для логирования (настройка уровней: info, warn, error).
- Добавить глобальный error‑handler middleware в Express для отлова и форматирования ошибок.

## 12. Валидация входящих запросов
- Использовать Joi или Zod для схем валидации `req.body`/`req.params`/`req.query`.
- Добавить middleware в маршрутах для автоматической проверки запросов.

## 13. Развитие тестирования
- Написать unit‑тесты для `services/lottery`, `services/approve`/`reject` (Jest).
- Интеграционные тесты API‑эндпоинтов с Supertest.
- Покрыть критичные сценарии фронтенда через React Testing Library или Cypress.

## 14. Сборка и раздача фронтенда
- Перенести презентационный код в отдельный React‑проект (CRA/Vite).
- Настроить `npm run build` и статическую раздачу через Express (`app.use(express.static('build'))`).
- Оптимизировать сборку (минификация, tree‑shaking).

## 15. Docker и CI/CD
- Создать `Dockerfile` и `docker-compose.yml` (API + SQLite).
- Настроить GitHub Actions: тесты, линтинг, сборка и деплой в Docker Registry или платформы (Railway/Heroku).

## 16. Безопасность и конфигурация
- Все секреты хранить в `.env` или секрет‑менеджере (Vault/Github Secrets).
- Добавить rate‑limiting (express-rate-limit), CORS‑политику, HTTP‑заголовки (helmet).
- Настроить HTTPS через reverse‑proxy (NGINX, Cloudflare).

## 17. Мониторинг и алерты
- Интегрировать Sentry для отслеживания ошибок runtime.
- Подключить метрики (Prometheus/Grafana) и лог‑коллектор (LogDNA).

## 18. Обновление документации и README
- Описать шаги установки, настройки `.env`, запуск проекта и API-примеры.
- Сгенерировать Swagger/OpenAPI спецификацию для REST API.

*После выполнения каждого пункта рекомендуется проверять корректность работы системы и добавлять необходимые тесты.*
*После внесения изменений проверять функциональность и дополнять тесты.*
